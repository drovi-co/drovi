# Drovi Intelligence Backend Environment Variables

# Database (shared with TypeScript backend)
DATABASE_URL=postgresql+asyncpg://postgres:password@localhost:5432/memorystack

# FalkorDB (Graph Database - Redis-compatible)
FALKORDB_HOST=localhost
FALKORDB_PORT=6379
FALKORDB_GRAPH_NAME=drovi

# Redis (for events/caching)
REDIS_URL=redis://localhost:6379/0

# LLM Providers - Open Source (Preferred)
TOGETHER_API_KEY=tgp_...
FIREWORKS_API_KEY=...
HUGGINGFACE_API_KEY=...

# LLM Providers - Proprietary (Fallback)
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...
GOOGLE_AI_API_KEY=...

# LLM Settings - Open Source Defaults
DEFAULT_MODEL_FAST=moonshotai/Kimi-K2.5
DEFAULT_MODEL_BALANCED=moonshotai/Kimi-K2.5
DEFAULT_MODEL_POWERFUL=moonshotai/Kimi-K2.5
EMBEDDING_MODEL=togethercomputer/m2-bert-80M-32k-retrieval

# LLM Settings - Legacy
DEFAULT_LLM_MODEL=gpt-4o
FALLBACK_LLM_MODEL=claude-3-5-sonnet-20241022

# TypeScript Backend Integration
TS_BACKEND_URL=http://localhost:3000
TS_INTERNAL_SECRET=your-internal-secret

# API Settings
API_KEY_SALT=your-api-key-salt
# CORS_ORIGINS must be JSON array format for Pydantic
CORS_ORIGINS=["http://localhost:5173","http://localhost:3000"]

# Logging
LOG_LEVEL=INFO
LOG_FORMAT=json

# Performance
MAX_CONCURRENT_ANALYSES=10
LLM_RATE_LIMIT_PER_MINUTE=60
CIRCUIT_BREAKER_THRESHOLD=5
CIRCUIT_BREAKER_RESET_SECONDS=30

# Scheduler
SCHEDULER_RUN_IN_API=true
SCHEDULER_ADVISORY_LOCK_ID=4242001
WEEKLY_REPORTS_ENABLED=true
WEEKLY_REPORTS_CRON=0 9 * * MON
WEEKLY_REPORTS_PILOT_ONLY=true
WEEKLY_BRIEF_DAYS=7
WEEKLY_BLINDSPOT_DAYS=30
DAILY_REPORTS_ENABLED=true
DAILY_REPORTS_CRON=0 9 * * *
DAILY_REPORTS_PILOT_ONLY=true
DAILY_BRIEF_DAYS=1
REPORTS_EMAIL_ENABLED=false
REPORTS_EMAIL_FALLBACK_TO_MEMBERS=true
REPORTS_EMAIL_SUBJECT_PREFIX=
RESEND_API_KEY=
RESEND_FROM=
RESEND_REPLY_TO=
RESEND_API_URL=https://api.resend.com
RESEND_TIMEOUT_SECONDS=10

# Candidate processing
CANDIDATE_PROCESSING_ENABLED=true
CANDIDATE_PROCESSING_INTERVAL_SECONDS=60

# Evidence Storage (S3/MinIO)
EVIDENCE_STORAGE_BACKEND=s3
EVIDENCE_S3_BUCKET=drovi-evidence
EVIDENCE_S3_ENDPOINT_URL=http://localhost:9000
EVIDENCE_S3_ACCESS_KEY_ID=minioadmin
EVIDENCE_S3_SECRET_ACCESS_KEY=minioadmin
EVIDENCE_S3_PREFIX=drovi-evidence
EVIDENCE_S3_PRESIGN_EXPIRY_SECONDS=3600

# Kafka Streaming
KAFKA_ENABLED=false
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_SECURITY_PROTOCOL=PLAINTEXT
KAFKA_CONSUMER_GROUP_ID=drovi-intelligence
KAFKA_AUTO_OFFSET_RESET=earliest
KAFKA_ENABLE_AUTO_COMMIT=false
KAFKA_BATCH_SIZE=100
KAFKA_LINGER_MS=10
KAFKA_TOPIC_RAW_EVENTS=drovi-raw-events
KAFKA_TOPIC_INTELLIGENCE=drovi-intelligence
KAFKA_TOPIC_GRAPH_CHANGES=drovi-graph-changes
KAFKA_WORKER_CONCURRENCY=4
KAFKA_QUEUE_MAXSIZE=1000
# JSON map: {"drovi-raw-events":0,"drovi-intelligence":1,"drovi-graph-changes":2}
KAFKA_TOPIC_PRIORITIES={"drovi-raw-events":0,"drovi-intelligence":1,"drovi-graph-changes":2}

# Live Streaming
STREAMING_QUEUE_SIZE=256
STREAMING_WORKER_CONCURRENCY=2
STREAMING_MAX_CHUNK_BYTES=5000000
STREAMING_MAX_LATENCY_MS=5000

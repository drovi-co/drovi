# Kafka Connect FalkorDB Sink Connector Configuration
#
# This configuration enables real-time streaming from Kafka to FalkorDB
# Part of Phase 3 (Real-Time) of the FalkorDB enhancement plan.

# Connector metadata
name=drovi-falkordb-sink
connector.class=io.debezium.connector.redis.RedisSinkConnector

# Task configuration
tasks.max=4

# Kafka topics to consume from
topics=drovi-intelligence,drovi-raw-events,drovi-graph-changes

# FalkorDB connection (FalkorDB is Redis-compatible)
redis.host=${FALKORDB_HOST:-localhost}
redis.port=${FALKORDB_PORT:-6379}
redis.password=${FALKORDB_PASSWORD:-}
redis.database=0

# Message conversion
key.converter=org.apache.kafka.connect.storage.StringConverter
value.converter=org.apache.kafka.connect.json.JsonConverter
value.converter.schemas.enable=false

# Error handling
errors.tolerance=all
errors.log.enable=true
errors.log.include.messages=true
errors.deadletterqueue.topic.name=drovi-dlq
errors.deadletterqueue.topic.replication.factor=1

# Retry configuration
retry.backoff.ms=1000
max.retries=5

# Batch configuration for performance
batch.size=100
linger.ms=10

# Consumer configuration
consumer.auto.offset.reset=earliest

# Transforms for routing to different graphs based on message type
transforms=extractType,routeByType
transforms.extractType.type=org.apache.kafka.connect.transforms.ExtractField$Key
transforms.extractType.field=type
transforms.routeByType.type=org.apache.kafka.connect.transforms.RegexRouter
transforms.routeByType.regex=(.*)
transforms.routeByType.replacement=drovi_$1

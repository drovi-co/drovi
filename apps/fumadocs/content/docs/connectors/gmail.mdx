---
title: Gmail Connector
description: Connect Gmail and Google Workspace to Drovi Intelligence
---

# Gmail Connector

The Gmail connector enables Drovi Intelligence to automatically process your emails and extract intelligence.

## Prerequisites

- A Google account (personal Gmail or Google Workspace)
- Admin consent for Google Workspace (if using organizational account)

## Setup

### 1. Create a Connection

```bash
curl -X POST https://api.drovi.io/api/v1/connections \
  -H "X-API-Key: your_api_key" \
  -H "Content-Type: application/json" \
  -d '{
    "organization_id": "org_123",
    "connector_type": "gmail",
    "name": "Work Gmail",
    "config": {
      "lookback_days": 90,
      "sync_labels": ["INBOX", "SENT"],
      "exclude_labels": ["SPAM", "TRASH"]
    }
  }'
```

### 2. Complete OAuth Authorization

The response includes an `auth_url`. Redirect the user to complete OAuth:

```json
{
  "connection_id": "conn_abc123",
  "status": "pending_auth",
  "auth_url": "https://accounts.google.com/o/oauth2/v2/auth?..."
}
```

### 3. OAuth Callback

After authorization, Google redirects to your callback URL. Drovi handles the token exchange automatically.

## Configuration Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `lookback_days` | integer | 30 | Days of historical email to sync |
| `sync_labels` | array | ["INBOX", "SENT"] | Gmail labels to sync |
| `exclude_labels` | array | ["SPAM", "TRASH"] | Labels to exclude |
| `include_attachments` | boolean | false | Process attachment content |
| `max_attachment_size_mb` | integer | 10 | Max attachment size to process |

## Permissions Required

The Gmail connector requests these OAuth scopes:

| Scope | Purpose |
|-------|---------|
| `gmail.readonly` | Read email messages and metadata |
| `gmail.labels` | Access label information |
| `userinfo.email` | Identify the connected account |

<Callout type="info">
Drovi only requests read-only access. We never send, delete, or modify your emails.
</Callout>

## Real-Time Updates

The Gmail connector uses [Google Cloud Pub/Sub](https://developers.google.com/gmail/api/guides/push) for real-time notifications:

1. When a new email arrives, Google sends a push notification
2. Drovi fetches the new message(s)
3. Intelligence is extracted and added to the graph

Latency: Typically **under 30 seconds** from email receipt to intelligence extraction.

## Data Extracted

From each email, Drovi extracts:

| Field | Description |
|-------|-------------|
| Subject | Email subject line |
| Body | Plain text and HTML content |
| From | Sender information |
| To/Cc/Bcc | Recipients |
| Thread ID | For conversation threading |
| Labels | Gmail labels/folders |
| Timestamp | Send/receive time |
| Attachments | Filenames and content (if enabled) |

## Example: Processed Email

**Original Email:**
```
From: john@acme.com
To: alice@company.com
Subject: Q4 Report Follow-up

Hi Alice,

Thanks for the meeting yesterday. As discussed, I will send you
the final Q4 report by end of week.

Can you confirm the budget numbers we talked about? I want to
make sure we're aligned before the board presentation.

Also, we decided to go with Option B for the marketing campaign.

Best,
John
```

**Extracted Intelligence:**

```json
{
  "commitments": [
    {
      "title": "Send final Q4 report",
      "direction": "owed_to_me",
      "counterparty": "John",
      "due_date_text": "end of week",
      "confidence": 0.95
    }
  ],
  "decisions": [
    {
      "title": "Go with Option B for marketing campaign",
      "status": "made",
      "confidence": 0.88
    }
  ],
  "questions": [
    {
      "question": "Confirm budget numbers",
      "status": "open",
      "directed_to": "Alice"
    }
  ]
}
```

## Troubleshooting

### Connection shows "error" status

Check the `error_message` field in the connection details:

```bash
curl -X GET "https://api.drovi.io/api/v1/connections/conn_abc123?organization_id=org_123" \
  -H "X-API-Key: your_api_key"
```

Common errors:

| Error | Solution |
|-------|----------|
| `invalid_grant` | Token expired. Re-authenticate the connection. |
| `quota_exceeded` | Gmail API quota hit. Wait and retry. |
| `insufficient_permission` | Missing scopes. Re-authorize with full permissions. |

### Emails not syncing

1. Check connection status is `active`
2. Verify the email is in a synced label
3. Check if email is newer than the initial sync cutoff
4. Try triggering a manual sync

### Missing threads

Gmail threading can be complex. Ensure:
- Both sent and received labels are synced
- The thread hasn't been moved to an excluded label

## Rate Limits

Gmail API quotas:

| Limit | Value |
|-------|-------|
| Queries per day | 1,000,000,000 |
| Queries per user per second | 250 |

Drovi implements intelligent rate limiting and retries to stay within quotas.

## Security

- OAuth tokens encrypted at rest with AES-256
- Tokens refreshed automatically (no stored passwords)
- Connection can be revoked at any time
- All data transmitted over TLS 1.3

To revoke access:
1. Delete the connection in Drovi
2. Visit [Google Account Security](https://myaccount.google.com/permissions) to revoke app access
